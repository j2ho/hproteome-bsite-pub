<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>{{ligandinstance}}</title>

    <!-- Molstar CSS & JS -->
    <link rel="stylesheet" type="text/css" href="/static/molstar2.css">
    <script type="text/javascript" src="/static/molstar.js"></script>
    <style>
      #myViewer{
        width:450px;
        height: 450px;
        position:relative;
      }
    </style>
  </head>

  <body>
      <div style="margin-top:20px; margin-left:20px;">
    <h2>Ligand Details</h2>
    <hr>
    <h3>{{ligandinstance.liguniquename}}</h3>
    <p>&nbsp(UniProt_Fragment_Domain_SearchMethod_rank_Ligand)</p>
    <hr>
    <p>Mol* Viewer</p>
    <div id="myViewer">
<div class="msp-plugin">
    <div class="msp-plugin-content msp-layout-standard msp-layout-standard-outside">
        <div class="msp-layout-hide-top msp-layout-hide-left msp-layout-hide-right msp-layout-hide-bottom">
            <div class="msp-layout-region msp-layout-main">
                <div class="msp-layout-static">
                    <div class="msp-viewport">
                        <div class="msp-viewport-host3d">
                            <canvas width="1340" height="1196" style="width: 670px; height: 598px;"></canvas>
                        </div>
                        <a class="msp-logo" href="https://molstar.org" target="_blank"></a>
                    </div>
                    <div class="msp-viewport-top-left-controls">
                        <div class="msp-animation-viewport-controls">
                            <div>
                                <div class="msp-semi-transparent-background"></div>
                                <button class="msp-btn msp-btn-icon msp-btn-link-toggle-off msp-transparent-bg" title="Select Animation">
                                    <span class="msp-icon msp-material-icon">
                                        <svg width="24px" height="24px" viewBox="0 0 24 24">
                                            <path d="M4 6h16v2H4zm2-4h12v2H6zm14 8H4c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2v-8c0-1.1-.9-2-2-2zm0 10H4v-8h16v8zm-10-7.27v6.53L16 16z">
                                            </path>
                                        </svg>
                                    </span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="msp-viewport-controls">
                        <div class="msp-viewport-controls-buttons">
                            <div>
                                <div class="msp-semi-transparent-background"></div>
                                <button class="msp-btn msp-btn-icon msp-btn-link-toggle-on" title="Reset Camera" style="background: transparent;">
                                    <span class="msp-icon msp-material-icon">
                                        <svg width="24px" height="24px" viewBox="0 0 24 24">
                                            <path d="M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z">
                                            </path>
                                        </svg>
                                    </span>
                                </button>
                            </div>
                            <div>
                                <div class="msp-semi-transparent-background"></div>
                                <button class="msp-btn msp-btn-icon msp-btn-link-toggle-off" title="Screenshot / State Snapshot" style="background: transparent;">
                                    <span class="msp-icon msp-material-icon">
                                        <svg width="24px" height="24px" viewBox="0 0 24 24">
                                            <path d="M14.25 2.26l-.08-.04-.01.02C13.46 2.09 12.74 2 12 2 6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10c0-4.75-3.31-8.72-7.75-9.74zM19.41 9h-7.99l2.71-4.7c2.4.66 4.35 2.42 5.28 4.7zM13.1 4.08L10.27 9l-1.15 2L6.4 6.3C7.84 4.88 9.82 4 12 4c.37 0 .74.03 1.1.08zM5.7 7.09L8.54 12l1.15 2H4.26C4.1 13.36 4 12.69 4 12c0-1.85.64-3.55 1.7-4.91zM4.59 15h7.98l-2.71 4.7c-2.4-.67-4.34-2.42-5.27-4.7zm6.31 4.91L14.89 13l2.72 4.7C16.16 19.12 14.18 20 12 20c-.38 0-.74-.04-1.1-.09zm7.4-3l-4-6.91h5.43c.17.64.27 1.31.27 2 0 1.85-.64 3.55-1.7 4.91z"></path>
                                        </svg>
                                    </span>
                                </button>
                            </div>
                            <div>
                                <div class="msp-semi-transparent-background">
                                </div>
                                <button class="msp-btn msp-btn-icon msp-btn-link-toggle-off" title="Toggle Controls Panel" style="background: transparent;">
                                    <span class="msp-icon msp-material-icon">
                                        <svg width="24px" height="24px" viewBox="0 0 24 24">
                                            <path d="M22.61 18.99l-9.08-9.08c.93-2.34.45-5.1-1.44-7C9.79.61 6.21.4 3.66 2.26L7.5 6.11 6.08 7.52 2.25 3.69C.39 6.23.6 9.82 2.9 12.11c1.86 1.86 4.57 2.35 6.89 1.48l9.11 9.11c.39.39 1.02.39 1.41 0l2.3-2.3c.4-.38.4-1.01 0-1.41zm-3 1.6l-9.46-9.46c-.61.45-1.29.72-2 .82-1.36.2-2.79-.21-3.83-1.25C3.37 9.76 2.93 8.5 3 7.26l3.09 3.09 4.24-4.24-3.09-3.09c1.24-.07 2.49.37 3.44 1.31 1.08 1.08 1.49 2.57 1.24 3.96-.12.71-.42 1.37-.88 1.96l9.45 9.45-.88.89z"></path>
                                        </svg>
                                    </span>
                                </button>
                                <button class="msp-btn msp-btn-icon msp-btn-link-toggle-off" title="Toggle Expanded Viewport" style="background: transparent;">
                                    <span class="msp-icon msp-material-icon">
                                        <svg width="24px" height="24px" viewBox="0 0 24 24">
                                            <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"></path>
                                        </svg>
                                    </span>
                                </button>
                                <button class="msp-btn msp-btn-icon msp-btn-link-toggle-off" title="Settings / Controls Info" style="background: transparent;">
                                    <span class="msp-icon msp-material-icon"><svg width="24px" height="24px" viewBox="0 0 24 24"><path d="M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"></path>
                                        </svg>
                                    </span>
                                </button>
                            </div>
                            <div>
                                <div class="msp-semi-transparent-background"></div>
                                <button class="msp-btn msp-btn-icon msp-btn-link-toggle-off" title="Toggle Selection Mode" style="background: transparent;">
                                    <span class="msp-icon msp-material-icon"><svg width="24px" height="24px" viewBox="0 0 24 24"><path d="M10.07,14.27C10.57,14.03 11.16,14.25 11.4,14.75L13.7,19.74L15.5,18.89L13.19,13.91C12.95,13.41 13.17,12.81 13.67,12.58L13.95,12.5L16.25,12.05L8,5.12V15.9L9.82,14.43L10.07,14.27M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z"></path></svg></span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="msp-background-tasks"></div>
                    <div class="msp-highlight-toast-wrapper"></div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>     

<div >
    <hr>
    <h3>Link to ligand RCSB - <a href="https://www.rcsb.org/ligand/{{ligand.ligname}}">{{ligandinstance}}</a></h3>
    <h3>Templates (PDBID_CHAIN_NUM_TMSCORE)</h3>
    <p>Click template name to conduct docking using that template</p>
            {% for template in ligandinstance.templates.all %}
            <ul>
                <li><p><a
                                   href="https://galaxy.seoklab.org/cgi-bin/submit_SITE_DOCK.cgi?job=docking&job_type=SITE_DOCK&template={{template.templ_chain_lignum}}&lig={{ligand.ligname}}&domain={{domain.name}}">{{template}}</a></p>
                </li>
                </ul> 
                            {% endfor %}
</div> 
      </div>
    <script type="text/javascript">
            var viewer = new molstar.Viewer('myViewer', {
                layoutIsExpanded: false,
                layoutShowControls: false,
                layoutShowRemoteState: false,
                layoutShowSequence: true,
                layoutShowLog: false,
                layoutShowLeftPanel: true,
                AnimationEffect: true,
                domainAnnotaion:true,
                viewportShowExpand: true,
                viewportShowSelectionMode: true,
                viewportShowAnimation: true,

                pdbProvider: 'rcsb',
                emdbProvider: 'rcsb',
            });
            //viewer.loadPdb('1fkb');

        function load_pdb(ligand) {
            viewer.clear();
        }

viewer.loadStructureFromUrl('/data/{{ligandinstance.dockedfile}}', 'pdb', false, { representationParams: {
    theme: { carbonColor: 'element-symbol'} } })

        </script>
  </body>

</html>
